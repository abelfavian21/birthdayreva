<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Selamat Ulang Tahun </title>
  <!-- Font Poppins -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>

  <style>
    body {
      margin: 0;
      font-family: "Poppins", sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      background-color: #F564A9;
      text-align: center;
      padding: 20px;
    }

    img {
      width: 200px;
      max-width: 80%;
      height: auto;
      border-radius: 20px;
      margin-bottom: 20px;
      opacity: 0;
      transform: scale(0.9);
      transition: opacity 0.6s ease, transform 0.6s ease;
    }

    h1, p {
      color: #F8F8E1;
      opacity: 0;
      transform: translateY(15px);
      transition: opacity 0.6s ease, transform 0.6s ease;
    }

    h1 {
      font-size: 2rem;
      margin: 10px 0;
    }

    p {
      font-size: 1.1rem;
      margin: 8px 0 25px;
      max-width: 500px;
      line-height: 1.5;
    }

    .btn {
      background: #ff4e50;
      color: #fff;
      padding: 12px 24px;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: bold;
      transition: 0.3s;
      text-decoration: none;
      font-family: inherit;
      display: inline-block;
      margin: 5px;
      opacity: 0;
      transform: scale(0.9);
      transition: opacity 0.6s ease, transform 0.6s ease;
    }

    .btn:hover {
      background: #fc913a;
      transform: scale(1.05);
    }

    .show {
      opacity: 1 !important;
      transform: scale(1) translateY(0) !important;
    }
  </style>
</head>
<body>
  <img id="mainImage" src="https://i.pinimg.com/originals/d8/38/6b/d8386b851201df6f588343240fd2524d.gif" alt="Kue Ulang Tahun üéÇ">
  
  <h1 id="title">Happy Birthday Revaa ‚ù§Ô∏è</h1>
  <p id="message">ciee udah ulang tahun aja nih :)</p>
  
  <!-- tombol awal -->
  <button id="tapBtn" class="btn">tap here <3</button>
  <!-- tombol setelah tap -->
  <div id="navButtons" style="display:none; margin-top:15px;">
    <a id="prevBtn" href="#" class="btn"> sebelumnya</a>
    <a id="nextBtn" href="#" class="btn">lanjut <3</a>
  </div>
 
  <!-- Puzzle Container (awal disembunyikan) -->
  <div id="puzzleContainer" style="display:none; text-align:center; margin-top:20px;">
    <h2 style="color:#fff;">üéÅ Puzzle Hadiah üéÅ</h2>
    <div id="puzzleBoard" 
      style="width:300px; height:300px; margin:20px auto;
            display:grid; grid-template-columns:repeat(3, 1fr); 
            grid-gap:3px; background:#f564a9; padding:3px; border-radius:12px;">
    </div>

    <div id="puzzleResult" style="display:none; margin-top:15px; color:#fff;">
      <p>üéâ Selamat! Puzzle selesai üéâ</p>
      <button id="toNineState" class="btn show">lanjut <3</button>
    </div>
  </div>

<script>
function initPuzzle() {
  const board = document.getElementById("puzzleBoard");
  board.innerHTML = "";
  const pieces = [];

  // generate 9 potongan (3x3)
  for (let row = 0; row < 3; row++) {
    for (let col = 0; col < 3; col++) {
      const piece = document.createElement("div");
      piece.style.width = "100px";
      piece.style.height = "100px";
      piece.style.backgroundImage = 'url("potobut.jpg")';
      piece.style.backgroundSize = "300px 300px";
      piece.style.backgroundPosition = `-${col * 100}px -${row * 100}px`;
      piece.style.border = "2px solid #fff";
      piece.style.borderRadius = "10px";
      piece.style.boxShadow = "0 2px 4px rgba(0,0,0,0.2)";
      piece.style.boxSizing = "border-box";

      piece.setAttribute("data-pos", row * 3 + col);
      piece.draggable = true;
      pieces.push(piece);
    }
  }

  // acak posisi
  pieces.sort(() => Math.random() - 0.5);
  pieces.forEach(p => board.appendChild(p));

  // drag & drop logic
  let dragged = null;
  board.addEventListener("dragstart", e => {
    dragged = e.target;
  });
  board.addEventListener("dragover", e => {
    e.preventDefault();
  });
  board.addEventListener("drop", e => {
    e.preventDefault();
    if (e.target !== dragged && e.target.parentNode === board) {
      const draggedIndex = Array.from(board.children).indexOf(dragged);
      const targetIndex = Array.from(board.children).indexOf(e.target);
      if (draggedIndex > targetIndex) {
        board.insertBefore(dragged, e.target);
      } else {
        board.insertBefore(dragged, e.target.nextSibling);
      }
    }
    checkWin();
  });

  function checkWin() {
    const current = Array.from(board.children).map(c => c.getAttribute("data-pos"));
    const solved = current.every((pos, idx) => pos == idx);
    if (solved) {
      document.getElementById("puzzleResult").style.display = "block";

      // üéâ Confetti effect
      confetti({
        particleCount: 150,
        spread: 90,
        origin: { y: 0.6 }
      });
    }
  }
}
</script>

  <!-- üéµ Backsound -->
  <audio id="bgm" autoplay loop>
    <source src="music.mp3" type="audio/mpeg">
    Browser kamu tidak mendukung audio tag.
  </audio>

  <script>
    const img = document.getElementById("mainImage");
    const title = document.getElementById("title");
    const message = document.getElementById("message");
    const tapBtn = document.getElementById("tapBtn");
    const navButtons = document.getElementById("navButtons");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");

    // state objects
    const firstState = {
      img: "https://i.pinimg.com/originals/d8/38/6b/d8386b851201df6f588343240fd2524d.gif",
      title: "Happy Birthday Revaa ‚ù§Ô∏è",
      message: "Semoga panjang umur, sehat selalu, dan bahagia terus!"
    };
  
    const secondState = {
      img: "https://i.pinimg.com/originals/11/82/59/118259993924863bd3f6457da365e2ac.gif",
      title: "Sudah 19 tahun ya",
      message: "wkwkwk dah makin tua aja üòú"
    };
  
    const threeState = {
      img: "https://i.pinimg.com/originals/6f/e0/d6/6fe0d6dff44f0a973cd7f2ab0b761ff1.gif",
      title: "Semoga Tahun Ini",
      message: "kamu bisa makin dewasa dan jadi lebih baik lagi"
    };
  
    const fourState = {
      img: "https://i.pinimg.com/originals/ee/fc/f7/eefcf78628bad11129d5761dea19d333.gif",
      title: "Semoga Semakin",
      message: "waras dan makin penyabar, jangan marah2 terus ya cantikk ‚ù§Ô∏è"
    };
    
    const fiveState = {
      img: "https://i.pinimg.com/originals/f2/b0/a8/f2b0a84979a2a2056732e21f1d08d389.gif",
      title: "Semangat terus",
      message: "kuliahnya, jan nyerah ya kalo nemu yang susah bilang aku kita stress bareng üò≠"
    };

    const sixState = {
      img: "https://i.pinimg.com/originals/de/ff/b6/deffb6e9cd6d5ab290f3297693b67985.gif",
      title: "Sehat selalu",
      message: "semoga kamu dan keluargamu sehat selalu, aminnn"
    };

    const sevenState = {
      img: "https://i.pinimg.com/originals/a2/6a/b7/a26ab7d6929010dcf4228d86c6c74e88.gif",
      title: "Semoga Juga",
      message: "harapan kamu yang belum tercapai bisa tercapai tahun in yaa...aminn"
    };

    const eightState = {
      img: "https://i.pinimg.com/originals/18/11/aa/1811aa8875aae61989cb04df9e9470ad.gif",
      title: "Masih Ada Kejutan",
      message: "selesaikan dulu puzzle nya... üëâ"
    };

    const nineState = {
      img: "https://i.pinimg.com/originals/9b/36/7b/9b367b34c79271552d740e164d98c3ec.gif",
      title: "Yeayy kamu berhasil menyelesaikan puzzlenya üéâ",
      message: "mau liat recap moment random <3",
      button: '<a href="moment.html" class="btn show">Lihat Moment üíñ</a>'
};

  
    const states = [
      firstState,
      secondState,
      threeState,
      fourState,
      fiveState,
      sixState,
      sevenState,
      eightState,
      nineState
    ];
  
    let currentIndex = 0;
  
    window.addEventListener("load", () => {
      img.classList.add("show");
      title.classList.add("show");
      message.classList.add("show");
      tapBtn.classList.add("show");
    });
  
    function showStateByIndex(index, callback) {
      const state = states[index];
      img.classList.remove("show");
      title.classList.remove("show");
      message.classList.remove("show");
      setTimeout(() => {
        img.src = state.img;
        title.innerText = state.title;
        message.innerText = state.message;
        img.style.display = "block";
        title.style.display = "block";
        message.style.display = "block";
        img.classList.add("show");
        title.classList.add("show");
        message.classList.add("show");
        currentIndex = index;
        // kalau ada tombol tambahan di state
    if (state.button) {
      message.insertAdjacentHTML("afterend", state.button);
    } else {
      const oldBtn = document.querySelector(".btn.show[href='moment.html']");
      if (oldBtn) oldBtn.remove();
    }
        if (callback) callback();
      }, 600);
    }
  
    tapBtn.addEventListener("click", () => {
      const bgm = document.getElementById("bgm");
      bgm.play().catch(err => console.log("Autoplay diblokir:", err));
  
      showStateByIndex(1, () => {
        tapBtn.style.display = "none";
        navButtons.style.display = "block";
        setTimeout(() => {
          navButtons.querySelectorAll(".btn").forEach(btn => btn.classList.add("show"));
        }, 50);
      });
    });
  
    prevBtn.addEventListener("click", (e) => {
      e.preventDefault();
      if (currentIndex > 0) {
        const newIndex = currentIndex - 1;
        if (newIndex === 0) {
          showStateByIndex(0, () => {
            navButtons.style.display = "none";
            tapBtn.style.display = "inline-block";
            setTimeout(() => tapBtn.classList.add("show"), 50);
          });
        } else {
          showStateByIndex(newIndex);
        }
      }
    });
  
    nextBtn.addEventListener("click", (e) => {
      e.preventDefault();
      if (currentIndex < states.length - 2) {
        showStateByIndex(currentIndex + 1);
      } else {
        img.style.display = "none";
        title.style.display = "none";
        message.style.display = "none";
        navButtons.style.display = "none";
        document.getElementById("puzzleContainer").style.display = "block";
        initPuzzle();
      }
    });

     
    document.getElementById("toNineState").addEventListener("click", () => {
      document.getElementById("puzzleContainer").style.display = "none";
      navButtons.style.display = "none";
      showStateByIndex(8, () => {
        // confetti lagi pas masuk nineState
        confetti({
          particleCount: 200,
          spread: 120,
          origin: { y: 0.6 }
        });
      });
    });
  </script>
</body>
<canvas id="confettiCanvas" style="position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:9999;"></canvas>
</html>
